<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Al-Huda User Flow Visualization</title>
    <style>
        body {
            background-color: #102216;
            /* Deep Forest */
            color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h1 {
            color: #13ec5b;
            /* Emerald Primary */
        }

        .mermaid {
            background-color: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            display: flex;
            justify-content: center;
        }
    </style>
</head>

<body>

    <h1>User Flow: Splash to Reading</h1>
    <p>Logic flow determining Normal vs. Focus Mode</p>

    <div class="mermaid">
        graph TD
        %% Nodes
        Splash[Splash Screen\nChecking Auth]
        Onboarding[Onboarding Flow\nNew User]
        Auth[Auth Screen\nLogin/Signup]
        Setup[Goal Setup Screen\nSet Preferred Times]

        Home[Home Screen\nDashboard]

        %% Reading Flows
        CheckTime{Is it\nScheduled Time?}
        NormalRead[Reading Screen\nNormal Mode]
        FocusRead[Reading Screen\nFocus Mode]

        %% Logic
        Splash -- No Token --> Onboarding
        Onboarding --> Auth
        Auth --> Setup
        Setup --> Home

        Splash -- Token Valid --> Home

        %% Reading Entry Points
        Home -- User Taps 'Resume' --> CheckTime
        Home -- User Taps 'Quran' --> CheckTime

        CheckTime -- Yes --> FocusRead
        CheckTime -- No --> NormalRead

        %% Focus Mode Details
        FocusRead -- Auto-Start --> Timer[Timer Overlay\nActive]
        Timer --> Blocker[App Blocker\nActive]

        %% Session End
        NormalRead -- Back/Exit --> SavePos[Save Position]
        FocusRead -- End Session --> Summary[Session Summary\nStats & Hasanat]
        Summary --> Home

        %% Styling
        style FocusRead fill:#13ec5b,color:#000,stroke:#d4af37,stroke-width:2px
        style NormalRead fill:#102216,color:#fff,stroke:#4ff285
        style CheckTime fill:#1c271f,color:#fff,stroke:#d4af37
    </div>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#13ec5b',
                primaryTextColor: '#000',
                primaryBorderColor: '#13ec5b',
                lineColor: '#4ff285',
                secondaryColor: '#102216',
                tertiaryColor: '#1c271f'
            }
        });
    </script>

</body>

</html>